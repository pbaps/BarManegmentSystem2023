@model BarManegment.Models.OralExamCommittee
@{
    ViewBag.Title = "أوراق تقييم أعضاء اللجنة";
    Layout = "~/Areas/Admin/Views/Shared/_PrintDocumentsLayout.cshtml";
}

<style>
    .sheet-page { page-break-after: always; padding: 20px; }
    .sheet-header { text-align: center; border-bottom: 2px double #333; margin-bottom: 20px; padding-bottom: 10px; }
    .member-info { background: #f9f9f9; padding: 10px; border: 1px solid #ccc; margin-bottom: 20px; border-radius: 5px; }
    .eval-table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
    .eval-table th, .eval-table td { border: 1px solid #000; padding: 8px; text-align: center; vertical-align: middle; }
    .eval-table th { background-color: #eee; }
    .trainee-col { text-align: right !important; font-weight: bold; width: 25%; }
    .criteria-col { width: 10%; font-size: 10px; }

    @@media print {
        .sheet-page { height: 100vh; }
    }
</style>

<!-- نقوم بتكرار الصفحة لكل عضو في اللجنة -->
@foreach (var member in Model.Members)
{
    <div class="sheet-page">
        <div class="sheet-header">
            <h2>نقابة المحامين الفلسطينيين</h2>
            <h3>استمارة تقييم الاختبار الشفوي</h3>
        </div>

        <div class="member-info row">
            <div class="col-6"><strong>اللجنة:</strong> @Model.CommitteeName</div>
            <div class="col-6"><strong>التاريخ:</strong> @DateTime.Now.ToString("yyyy/MM/dd")</div>
            <div class="col-12 mt-2">
                <strong>الممتحن (عضو اللجنة):</strong> <span style="font-size: 1.2em;">@member.MemberLawyer.ArabicName</span> (@member.Role)
            </div>
        </div>

        <table class="eval-table">
            <thead>
                <tr>
                    <th rowspan="2" style="width: 5%;">م</th>
                    <th rowspan="2">اسم المتدرب</th>
                    <th colspan="4">معايير التقييم</th>
                    <th rowspan="2" style="width: 10%;">المجموع<br>(100)</th>
                    <th rowspan="2" style="width: 20%;">ملاحظات</th>
                </tr>
                <tr>
                    <th class="criteria-col">المظهر والشخصية<br>(20)</th>
                    <th class="criteria-col">سلامة اللغة والإلقاء<br>(20)</th>
                    <th class="criteria-col">المعلومات القانونية<br>(40)</th>
                    <th class="criteria-col">التحليل والاستنتاج<br>(20)</th>
                </tr>
            </thead>
            <tbody>
                @{ int i = 1; }
                @foreach (var enrollment in Model.Enrollments.OrderBy(e => e.Trainee.ArabicName))
                {
                    <tr>
                        <td>@(i++)</td>
                        <td class="trainee-col">
                            @enrollment.Trainee.ArabicName
                            <br>
                            <span style="font-weight: normal; font-size: 10px;">(@enrollment.Trainee.TraineeSerialNo)</span>
                        </td>
                        <td></td> <!-- المظهر -->
                        <td></td> <!-- اللغة -->
                        <td></td> <!-- المعلومات -->
                        <td></td> <!-- التحليل -->
                        <td></td> <!-- المجموع -->
                        <td></td> <!-- الملاحظات -->
                    </tr>
                }
            </tbody>
        </table>

        <div style="margin-top: 40px;">
            <div style="float: left; width: 200px; text-align: center;">
                <strong>توقيع العضو الممتحن</strong>
                <br><br><br>
                ____________________
            </div>
        </div>
    </div>
}

<div class="no-print text-center mt-4">
    <button onclick="window.print()" class="btn btn-primary btn-lg"><i class="bi bi-printer"></i> طباعة الاستمارات لجميع الأعضاء</button>
    <a href="@Url.Action("Details", new { id = Model.Id })" class="btn btn-secondary btn-lg">عودة</a>
</div>
