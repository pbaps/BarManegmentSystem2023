@model BarManegment.Models.GraduateApplication
@{
    Layout = "~/Areas/Admin/Views/Shared/_PrintDocumentsLayout.cshtml";
}

<style>
    /* استيراد الخطوط */
    @@import url('https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&display=swap');

    .page {
        font-family: 'Amiri', 'Traditional Arabic', serif;
        background-image: url('/Content/Images/logo-watermark.png');
        background-repeat: no-repeat;
        background-position: center;
        background-size: 65%;
        padding: 20mm 25mm;
        color: #000;
        direction: rtl;
    }

    /* تنسيق الترويسة */
    .header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        border-bottom: 3px double #ce1126;
        padding-bottom: 15px;
        margin-bottom: 30px;
    }

    .header-right {
        text-align: right;
        width: 35%;
    }

    .header-left {
        text-align: left;
        direction: ltr;
        width: 35%;
    }

    .org-name-ar {
        color: #ce1126;
        font-weight: 900;
        font-size: 16pt;
        margin-bottom: 5px;
        line-height: 1.2;
    }

    .org-name-en {
        color: #ce1126;
        font-weight: 900;
        font-size: 13pt;
        margin-bottom: 5px;
        text-transform: uppercase;
        line-height: 1.2;
    }

    .sub-text {
        font-size: 10pt;
        font-weight: bold;
        color: #000;
        line-height: 1.4;
    }

    .logo-box {
        text-align: center;
        width: 30%;
    }

    .logo-img {
        width: 100px;
        height: auto;
    }

    /* عنوان الإفادة */
    .doc-title {
        text-align: center;
        margin: 40px 0 30px 0;
    }

        .doc-title h1 {
            font-size: 24pt;
            font-weight: 900;
            display: inline-block;
            border-bottom: 2px solid #000;
            padding-bottom: 5px;
            margin: 0;
        }

    /* جسم الإفادة */
    .content-body {
        font-size: 18pt;
        font-weight: bold;
        line-height: 2.2;
        text-align: right;
        margin-top: 20px;
        width: 100%;
    }

    .intro-line {
        text-align: center;
        margin-bottom: 30px;
        font-size: 16pt;
        text-decoration: underline;
        text-underline-offset: 8px;
    }

    /* تنسيق الأسطر */
    .data-line {
        display: flex;
        justify-content: space-between;
        align-items: flex-end;
        margin-bottom: 15px;
        flex-wrap: nowrap;
    }

    .data-label {
        white-space: nowrap;
    }

    .data-field {
        border-bottom: 1px dotted #000;
        text-align: center;
        padding: 0 5px;
        font-family: 'Arial', sans-serif;
        font-weight: normal;
        font-size: 16pt;
        flex-grow: 1;
        margin: 0 10px;
        display: inline-block;
        min-width: 50px;
    }

    /* التذييل والتوقيع */
    .footer-section {
        margin-top: 60px;
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        font-size: 14pt;
        font-weight: bold;
    }

    .date-section {
        text-align: right;
        width: 40%;
        padding-right: 20px;
    }

    .signature-section {
        text-align: center;
        width: 40%;
        padding-left: 20px;
    }

    .bottom-bar {
        position: absolute;
        bottom: 15mm;
        left: 15mm;
        right: 15mm;
        border-top: 2px solid #ce1126;
        padding-top: 10px;
        font-size: 10pt;
        font-weight: bold;
        text-align: center;
        color: #ce1126;
    }

    /* لوحة التحكم */
    .signature-settings {
        background-color: #f8f9fa;
        border: 1px solid #dee2e6;
        border-radius: 8px;
        padding: 15px;
        margin: 20px auto;
        width: 210mm;
        direction: rtl;
    }
</style>

<!-- لوحة تحكم التوقيع -->
<div class="no-print signature-settings shadow-sm">
    <h6 class="fw-bold text-primary mb-3"><i class="bi bi-pen-fill"></i> إعدادات التوقيع</h6>
    <div class="row g-3">
        <div class="col-md-4">
            <label class="small text-muted">اختر الموقع:</label>
            <select id="signerSelect" class="form-select form-select-sm" onchange="updateSigner()">
                <option value="none">-- بدون توقيع --</option>
                <option value="صافي الدحدوح|نائب نقيب المحامين" selected>نائب النقيب (صافي الدحدوح)</option>
                <option value="زياد عطا النجار|أمين السر">أمين السر (زياد النجار)</option>
                <option value="علي الدن|أمين الصندوق">أمين الصندوق (علي الدن)</option>
                <option value="custom">--- إدخال يدوي ---</option>
            </select>
        </div>
        <div class="col-md-4">
            <label class="small text-muted">الاسم:</label>
            <input type="text" id="signerNameInput" class="form-control form-control-sm" oninput="syncSignerDisplay()">
        </div>
        <div class="col-md-4">
            <label class="small text-muted">الصفة:</label>
            <input type="text" id="signerTitleInput" class="form-control form-control-sm" oninput="syncSignerDisplay()">
        </div>
    </div>
</div>

<div class="page">
    <!-- الترويسة -->
    <div class="header">
        <div class="header-right">
            <div class="org-name-ar">نقابة المحامين النظاميين الفلسطينيين</div>
            <div class="sub-text">القدس - المركز الرئيسي</div>
            <div class="sub-text">البيرة - شارع المبعدين</div>
            <div class="sub-text">غزة - مركز غزة</div>
            <div class="sub-text">غزة - أنصار - شارع الخرطوم</div>
        </div>
        <div class="logo-box">
            <img src="~/Content/Images/logo.png" class="logo-img" alt="Logo" onerror="this.style.display='none'" />
        </div>
        <div class="header-left">
            <div class="org-name-en">PALESTINIAN BAR ASSOCIATION</div>
            <div class="sub-text">The Main Center - Jerusalem</div>
            <div class="sub-text">Albireh - Al Mobadeen St.</div>
            <div class="sub-text">GAZA CENTER</div>
            <div class="sub-text">Gaza - Al - Khortoom St.</div>
        </div>
    </div>

    <div class="doc-title">
        <h1>إفـــــــــــــــــادة</h1>
    </div>

    <div class="content-body">
        <div class="intro-line">تفيد نقابة المحامين الفلسطينيين</div>

        <!-- السطر الأول -->
        <div class="data-line">
            <span class="data-label">بأن الأستاذ/ة</span>
            <span class="data-field">@Model.ArabicName</span>
            <span class="data-label">المحامي/ة</span>
        </div>

        <!-- السطر الثاني -->
        <div class="data-line" style="justify-content: right;">
            <span class="data-label  ">عضوية رقم /</span>
            <span class="data-field" style="max-width: 200px; flex-grow: 0; width: 200px;">@(Model.MembershipId ?? "---")</span>
        </div>

        <!-- السطر الثالث -->
        <div class="data-line">
            <span class="data-label">قد حصل على إجازة ممارسة مهنة المحاماة في فلسطين بتاريخ /</span>
            <span class="data-field" style="max-width: 150px; flex-grow: 0; width: 150px;">@(Model.PracticeStartDate.HasValue ? Model.PracticeStartDate.Value.ToString("yyyy/MM/dd") : "---")</span>
        </div>

        <!-- السطر الرابع -->
        <div class="data-line">
            <span class="data-label">ومسجل في سجل المحامين /</span>
            <span class="data-field" style="max-width: 150px;">مزاول</span>
            <span class="data-label">لعام /</span>
            <span class="data-field" style="max-width: 120px;">@DateTime.Now.Year</span>
        </div>

        <div style="text-align: center; margin-top: 50px; font-size: 16pt;">
            وقد أعطيت له هذه الإفادة بناءً على طلبه من واقع ملفه بالنقابة
        </div>
    </div>

    <!-- التذييل -->
    <div class="footer-section">
        <div class="date-section">
            حرر في : @DateTime.Now.ToString("yyyy/MM/dd")
        </div>

        <div class="signature-section" id="signatureSection">
            <div>نقابة المحامين الفلسطينيين - مركز غزة</div>
            <div id="displayTitle" style="margin-top: 10px;"></div>
            <div id="displayName" style="margin-top: 30px;"></div>
        </div>
    </div>

    <div class="bottom-bar">
        القدس عاصمة فلسطين الأبدية
    </div>
</div>

<script>
    function updateSigner() {
        var selected = document.getElementById("signerSelect").value;
        var section = document.getElementById("signatureSection");

        if (selected === "none") {
            section.style.visibility = "hidden";
            document.getElementById("signerNameInput").value = "";
            document.getElementById("signerTitleInput").value = "";
        } else {
            section.style.visibility = "visible";
            if (selected === "custom") {
                document.getElementById("signerNameInput").value = "";
                document.getElementById("signerTitleInput").value = "";
            } else {
                var parts = selected.split('|');
                var name = parts[0];
                var title = parts[0].includes("صافي") ? "المستشار " : "الأستاذ ";
                if (!name.includes("المستشار") && !name.includes("الأستاذ")) name = title + name;

                document.getElementById("signerNameInput").value = name;
                document.getElementById("signerTitleInput").value = parts[1];
            }
        }
        syncSignerDisplay();
    }

    function syncSignerDisplay() {
        document.getElementById("displayName").innerText = document.getElementById("signerNameInput").value;
        document.getElementById("displayTitle").innerText = document.getElementById("signerTitleInput").value;
    }

    window.onload = function () { updateSigner(); };
</script>