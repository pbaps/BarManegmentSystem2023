@model BarManegment.Models.GraduateApplication

@{
    Layout = null;
    var uniDegree = ViewBag.UniversityDegree as BarManegment.Models.Qualification;
}

<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="utf-8" />
    <title>تقرير بيانات متدرب - @Model.ArabicName</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Cairo', sans-serif;
            background-color: #f9f9f9;
        }

        .page {
            width: 210mm;
            min-height: 297mm;
            padding: 20mm;
            margin: 10mm auto;
            border: 1px solid #d3d3d3;
            border-radius: 5px;
            background: white;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
        }

        .header-section {
            border-bottom: 2px solid #000;
            padding-bottom: 10px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .section-title {
            background-color: #e9ecef;
            padding: 8px;
            margin: 20px 0 10px 0;
            font-weight: bold;
            border-right: 5px solid #0d6efd;
        }

        .info-row {
            margin-bottom: 8px;
        }

        .info-label {
            font-weight: bold;
            color: #555;
        }

        .profile-img {
            width: 120px;
            height: 120px;
            object-fit: cover;
            border: 1px solid #ddd;
            padding: 3px;
        }

        @@media print {
            body, .page {
                margin: 0;
                box-shadow: none;
                border: none;
                width: 100%;
            }

            .no-print {
                display: none;
            }
        }
    </style>
</head>
<body>

    <div class="page">
        <!-- Header -->
        <div class="header-section">
            <div class="text-center">
                <h4 class="m-0">نقابة المحامين الفلسطينيين</h4>
                <h6 class="m-0">لجنة التدريب</h6>
            </div>
            <div class="text-center">
                <h3 class="m-0">ملف متدرب</h3>
                <p class="m-0 text-muted">تاريخ الطباعة: @DateTime.Now.ToString("yyyy/MM/dd")</p>
            </div>
            <div style="width: 100px;">
                <!-- Logo Placeholder -->
                <div style="width: 80px; height: 80px; border: 1px dashed #ccc; border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                    
                    <img src="~/Content/Images/logo.png"   style="width: 85px;"/>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-9">
                <div class="section-title">البيانات الشخصية</div>
                <div class="row info-row">
                    <div class="col-6"><span class="info-label">الاسم الكامل:</span> @Model.ArabicName</div>
                    <div class="col-6"><span class="info-label">الاسم بالإنجليزية:</span> @Model.EnglishName</div>
                </div>
                <div class="row info-row">
                    <div class="col-6"><span class="info-label">رقم الهوية:</span> @Model.NationalIdNumber</div>
                    <div class="col-6"><span class="info-label">نوع الهوية:</span> @(Model.NationalIdType?.Name)</div>
                </div>
                <div class="row info-row">
                    <div class="col-6"><span class="info-label">تاريخ الميلاد:</span> @Model.BirthDate.ToString("yyyy/MM/dd")</div>
                    <div class="col-6"><span class="info-label">مكان الميلاد:</span> @Model.BirthPlace</div>
                </div>
                <div class="row info-row">
                    <div class="col-6"><span class="info-label">الجنسية:</span> @Model.Nationality</div>
                    <div class="col-6"><span class="info-label">الجنس:</span> @(Model.Gender?.Name)</div>
                </div>
            </div>
            <div class="col-3 text-center">
                @if (!string.IsNullOrEmpty(Model.PersonalPhotoPath))
                {
                    <img src="@Url.Content(Model.PersonalPhotoPath)" class="profile-img rounded" />
                }
                else
                {
                    <div class="profile-img rounded d-flex align-items-center justify-content-center bg-light">لا توجد صورة</div>
                }
                <div class="mt-2 fw-bold badge bg-light text-dark border">@Model.ApplicationStatus.Name</div>
            </div>
        </div>

        <div class="section-title">بيانات الاتصال</div>
        <div class="row info-row">
            <div class="col-6"><span class="info-label">المحافظة:</span> @(Model.ContactInfo?.Governorate)</div>
            <div class="col-6"><span class="info-label">المدينة/الحي:</span> @(Model.ContactInfo?.City)</div>
        </div>
        <div class="row info-row">
            <div class="col-12"><span class="info-label">العنوان التفصيلي:</span> @(Model.ContactInfo?.Street) - @(Model.ContactInfo?.BuildingNumber)</div>
        </div>
        <div class="row info-row">
            <div class="col-6"><span class="info-label">رقم الجوال:</span> @(Model.ContactInfo?.MobileNumber)</div>
            <div class="col-6"><span class="info-label">هاتف المنزل:</span> @(Model.ContactInfo?.HomePhoneNumber)</div>
        </div>
        <div class="row info-row">
            <div class="col-12"><span class="info-label">البريد الإلكتروني:</span> @(Model.ContactInfo?.Email)</div>
        </div>
        
        <div class="section-title">المؤهلات العلمية</div>
        @if (Model.Qualifications != null && Model.Qualifications.Any())
        {
            <table class="table table-bordered table-sm">
                <thead class="table-light">
                    <tr>
                        <th>المؤهل</th>
                        <th>الجامعة</th>
                        <th>الكلية/التخصص</th>
                        <th>سنة التخرج</th>
                        <th>التقدير</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var q in Model.Qualifications)
                    {
                        <tr>
                            <td>@q.QualificationType.Name</td>
                            <td>@q.UniversityName</td>
                            <td>@q.Faculty - @q.Specialization</td>
                            <td>@q.GraduationYear</td>
                            <td>@(q.GradePercentage.HasValue ? q.GradePercentage + "%" : "-")</td>
                        </tr>
                    }
                </tbody>
            </table>
        }
        else
        {
            <p class="text-muted">لا توجد مؤهلات مسجلة.</p>
        }

        <div class="section-title">بيانات التدريب</div>
        <div class="row info-row">
            <div class="col-6">
                <span class="info-label">المحامي المشرف الحالي:</span>
                @(Model.Supervisor?.ArabicName ?? "لم يتم التعيين")
            </div>
            <div class="col-6">
                <span class="info-label">رقم عضوية المشرف:</span>
                @(Model.Supervisor?.Id.ToString() ?? "-")
            </div>
        </div>
        <div class="row info-row">
            <div class="col-6"><span class="info-label">تاريخ التسجيل (التقديم):</span> @Model.SubmissionDate.ToString("yyyy/MM/dd")</div>
            <div class="col-6"><span class="info-label">تاريخ بدء التدريب الفعلي:</span> @(Model.TrainingStartDate?.ToString("yyyy/MM/dd") ?? "غير محدد")</div>
        </div>

        <div class="section-title">المرفقات</div>
        @if (Model.Attachments != null && Model.Attachments.Any())
        {
            <ul class="list-unstyled row">
                @foreach (var att in Model.Attachments)
                {
                    <li class="col-6 mb-1">
                        <i class="bi bi-paperclip"></i> @att.AttachmentType.Name
                        <small class="text-muted">(@att.UploadDate.ToString("yyyy/MM/dd"))</small>
                    </li>
                }
            </ul>
        }
        else
        {
            <p class="text-muted">لا توجد مرفقات.</p>
        }

        <!-- Footer -->
        <div style="margin-top: 50px; border-top: 1px solid #ccc; padding-top: 10px;">
            <div class="row text-center">
                <div class="col-4">
                    <p>مدقق البيانات</p>
                    <br>
                    <p>..................</p>
                </div>
                <div class="col-4">
                    <p>  رئيس لجنة التدريب</p>
                    <br>
                    <p>..................</p>
                </div>
                <div class="col-4">
                    <p>خاتم النقابة</p>
                </div>
            </div>
        </div>
    </div>

    <div class="text-center no-print my-4">
        <button onclick="window.print()" class="btn btn-primary btn-lg">طباعة التقرير</button>
        <button onclick="window.close()" class="btn btn-secondary btn-lg">إغلاق</button>
    </div>

</body>
</html>